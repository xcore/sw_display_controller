

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Project structure &mdash; Display controller component v documentation</title>

    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/globals.css"  type="text/css" />
    <link rel="stylesheet" href="_static/ui.css" type="text/css" />
    <link rel="stylesheet" href="_static/app.css"  type="text/css" />
    <link rel="stylesheet" href="_static/mobile.css"  type="text/css" />
    <link rel="stylesheet" href="_static/xde.css"
    type="text/css" /><script type="text/javascript" src="_static/scripts.js"></script>
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Display controller component v documentation" href="index.html" />
    <link rel="next" title="Programming guide" href="page3.html" />
    <link rel="prev" title="Evaluation platforms" href="page1.html" /> 
  </head>
  <body class="xde indented-content" onload="prepareContents();">  
          <div id="body">
             <div id="content">
             <h1>Project structure</h1>

             <div class='columns'>
            
  <dl class="docutils">
<dt>To build a project including the <tt class="docutils literal"><span class="pre">module_display_controller</span></tt> the following components are required:</dt>
<dd><ul class="first last">
<li>component: sc_sdram_burst which handles the SDRAM</li>
<li>component: sc_lcd which handles the LCD</li>
</ul>
</dd>
</dl>
<p>The below section details the APIs in the application. For details about the LCD and SDRAM APIs please refer to the respective repositories.</p>
<h2 class="topic" id="configuration-defines">Configuration defines</h2>
<div><p>The <tt class="docutils literal"><span class="pre">module_display_controller</span></tt> can be configured via the header <tt class="docutils literal"><span class="pre">display_controller_conf.h</span></tt>. The module requires nothing to be additionally defined however any of the defines can be overridden by adding the header <tt class="docutils literal"><span class="pre">display_controller_conf.h</span></tt> to the application project and adding the define that needs overridding. The possible defines are:</p>
<dl class="docutils">
<dt><strong>DISPLAY_CONTROLLER_MAX_IMAGES</strong></dt>
<dd><p>This defines the storage space allocated to the display controller for it to store image metadata. When an image is registered with the display controller its dimensions and location in SDRAM address space are stored in a table. The define specifies how many entries are allowed in that table. Note, there is no overflow checking by default.</p>
</dd>
<dt><strong>DISPLAY_CONTROLLER_VERBOSE</strong></dt>
<dd><p>This define switches on the error checking for memory overflows and causes verbose error warnings to be emitted in the event of an error.</p>
</dd>
</dl>
</div><h2 class="topic" id="api">API</h2>
<div><dl class="docutils">
<dt>The``module_display_controller`` functionality is defined in</dt>
<dd><ul class="first last">
<li><tt class="docutils literal"><span class="pre">display_controller_client.xc</span></tt></li>
<li><tt class="docutils literal"><span class="pre">display_controller_internal.h</span></tt></li>
<li><tt class="docutils literal"><span class="pre">display_controller.xc</span></tt></li>
<li><tt class="docutils literal"><span class="pre">display_controller.h</span></tt></li>
<li><tt class="docutils literal"><span class="pre">transitions.h</span></tt></li>
<li><tt class="docutils literal"><span class="pre">transitions.xc</span></tt></li>
</ul>
</dd>
</dl>
<p>The display controller handles the double buffering of the image data to the LCD as a real time service and manages the I/O to the SDRAM as a non-real time service.</p>
<p>The display controller API is as follows:</p>
<ul class='lib'><li class="function">
<h2 id="display_controller">
void <tt class="descname">display_controller</tt><big>(</big>chanend<em>&nbsp;c_client</em>, chanend<em>&nbsp;c_lcd</em>, chanend<em>&nbsp;c_sdram</em><big>)</big></h2>
<p>Function to manage the LCd c_server and SDRAM server whilst maintaining image buffers.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>c_client</h2>
<p>The channel from the display_controller to the client application.</p>
</li>
<li><h2>c_lcd</h2>
<p>The channel from the display_controller to the LCd c_server.</p>
</li>
<li><h2>c_sdram</h2>
<p>The channel from the display_controller to the SDRAM server.</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="display_controller_image_read_line">
void <tt class="descname">display_controller_image_read_line</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;line</em>, unsigned<em>&nbsp;image_no</em>, unsigned<em>&nbsp;buffer[]</em><big>)</big></h2>
<p>The function reads a line of pixel data from the SDRAM.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>c_server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>line</h2>
<p>The image line number to be read.</p>
</li>
<li><h2>image_no</h2>
<p>The image number whose line is to be read.</p>
</li>
<li><h2>buffer[]</h2>
<p>The buffer which is to be filled with the read data.</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="display_controller_image_read_line_p">
void <tt class="descname">display_controller_image_read_line_p</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;line</em>, unsigned<em>&nbsp;image_no</em>, intptr_t<em>&nbsp;buffer</em><big>)</big></h2>
<p>The function reads a line of pixel data from the SDRAM.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>c_server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>line</h2>
<p>The image line number to be read.</p>
</li>
<li><h2>image_no</h2>
<p>The image number whose line is to be read.</p>
</li>
<li><h2>buffer</h2>
<p>A pointer to the buffer which is to be filled with the read data.</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="display_controller_image_write_line">
void <tt class="descname">display_controller_image_write_line</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;line</em>, unsigned<em>&nbsp;image_no</em>, unsigned<em>&nbsp;buffer[]</em><big>)</big></h2>
<p>The function writes a line of pixel data to the registered image in SDRAM.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>c_server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>line</h2>
<p>The image line number to be written.</p>
</li>
<li><h2>image_no</h2>
<p>The image number whose line is to be written.</p>
</li>
<li><h2>buffer[]</h2>
<p>The buffer which is to be written to the image.</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="display_controller_image_write_line_p">
void <tt class="descname">display_controller_image_write_line_p</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;line</em>, unsigned<em>&nbsp;image_no</em>, intptr_t<em>&nbsp;buffer</em><big>)</big></h2>
<p>The function writes a line of pixel data to the registered image in SDRAM.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>c_server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>line</h2>
<p>The image line number to be written.</p>
</li>
<li><h2>image_no</h2>
<p>The image number whose line is to be written.</p>
</li>
<li><h2>buffer</h2>
<p>A pointer to the buffer which is to be written to the image.</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="display_controller_image_read_partial_line">
void <tt class="descname">display_controller_image_read_partial_line</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;line</em>, unsigned<em>&nbsp;image_no</em>, unsigned<em>&nbsp;buffer[]</em>, unsigned<em>&nbsp;line_offset</em>, unsigned<em>&nbsp;word_count</em>, unsigned<em>&nbsp;buffer_offset</em><big>)</big></h2>
<p>The function writes a partial line of pixel data to the registered image in SDRAM.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>c_server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>line</h2>
<p>The image line number to be written.</p>
</li>
<li><h2>image_no</h2>
<p>The image number whose line is to be written.</p>
</li>
<li><h2>buffer[]</h2>
<p>The buffer which is to be written to the image.</p>
</li>
<li><h2>line_offset</h2>
<p>The offset in pixels to begin the write of the image line from.</p>
</li>
<li><h2>word_count</h2>
<p>The number of words to write to the image line.</p>
</li>
<li><h2>buffer_offset</h2>
<p>The offset from the begining of the buffer to write from in words.</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="display_controller_image_read_partial_line_p">
void <tt class="descname">display_controller_image_read_partial_line_p</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;line</em>, unsigned<em>&nbsp;image_no</em>, intptr_t<em>&nbsp;buffer</em>, unsigned<em>&nbsp;line_offset</em>, unsigned<em>&nbsp;word_count</em>, unsigned<em>&nbsp;buffer_offset</em><big>)</big></h2>
<p>The function writes a partial line of pixel data to the registered image in SDRAM.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>c_server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>line</h2>
<p>The image line number to be written.</p>
</li>
<li><h2>image_no</h2>
<p>The image number whose line is to be written.</p>
</li>
<li><h2>buffer</h2>
<p>A pointer to the buffer which is to be written to the image.</p>
</li>
<li><h2>line_offset</h2>
<p>The offset in pixels to begin the write of the image line from.</p>
</li>
<li><h2>word_count</h2>
<p>The number of words to write to the image line.</p>
</li>
<li><h2>buffer_offset</h2>
<p>The offset from the begining of the buffer to write from in words.</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="display_controller_register_image">
unsigned <tt class="descname">display_controller_register_image</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;img_width_words</em>, unsigned<em>&nbsp;img_height_lines</em><big>)</big></h2>
<p>Registers an image with the display controller.</p>
<p>Returns an image handle to refer to the image from then on.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>img_width_words</h2>
<p>The width of the image in words.</p>
</li>
<li><h2>img_height_lines</h2>
<p>The height of the image in lines(pixels).</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="display_controller_wait_until_idle">
void <tt class="descname">display_controller_wait_until_idle</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;buffer[]</em><big>)</big></h2>
<p>Makes the display controller wait until the current SDRAM service has completed.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>buffer</h2>
<p>The buffer which is to be written to the image.</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="display_controller_wait_until_idle_p">
void <tt class="descname">display_controller_wait_until_idle_p</tt><big>(</big>chanend<em>&nbsp;c_server</em>, intptr_t<em>&nbsp;buffer</em><big>)</big></h2>
<p>Makes the display controller wait until the current SDRAM service has completed.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>c_server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>buffer</h2>
<p>A pointer to the buffer which is to be written to the image.</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="display_controller_frame_buffer_commit">
void <tt class="descname">display_controller_frame_buffer_commit</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;image_no</em><big>)</big></h2>
<p>Commits the image to the display controller to be displayed on the LCD screen when the current image is completly displayed.</p>
<p>The display controller contains a single next image number buffer meaning that if the buffer is empty (the previously commited image is already on the LCD screen) then the command will return immediatly. If the buffer is full then this function will block until the current image is on the LCD screen and the buffer is ready for a new entry. This behaviour ensures that frame commits will not overwrite.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>c_server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>image_no</h2>
<p>The image handle of the image to be displayed as per the described behaviour.</p>
</li>
</ul>
</div></li>

<li class="function">
<h2 id="display_controller_frame_buffer_init">
void <tt class="descname">display_controller_frame_buffer_init</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;image_no</em><big>)</big></h2>
<p>Commits the image to the display controller to be displayed on the LCD screen and initialises the display controller.</p>
<p>This must only be called once at the begining of the display controllers use.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>image_no</h2>
<p>The image handle of the image to be displayed as per the described behaviour.</p>
</li>
</ul>
</div></li>

</ul><p>The transition API is as follows:</p>
<ul class='lib'><li class="function">
<h2 id="transition_wipe">
unsigned <tt class="descname">transition_wipe</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;frame_buffer[2]</em>, unsigned<em>&nbsp;image_from</em>, unsigned<em>&nbsp;image_to</em>, unsigned<em>&nbsp;frames</em>, unsigned<em>&nbsp;cur_fb_index</em><big>)</big></h2>
<p>Transition effect: A -&gt; B as a wipe, i.e.</p>
<p>B wipes to A from the right.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>c_server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>frame_buffer</h2>
<p>An array of the frame buffer image handles.</p>
</li>
<li><h2>image_from</h2>
<p>The image handle of the image to transition from.</p>
</li>
<li><h2>image_to</h2>
<p>The image handle of the image to transition to.</p>
</li>
<li><h2>frames</h2>
<p>The number of frame to take over the course of the transisiton.</p>
</li>
<li><h2>cur_fb_index</h2>
<p>The initial index of the current frame in the frame_buffer .</p>
</li>
</ul>
</div><h3 class="nosecnum compact" id="">Returns</h3>
<div><p>The final index of the current frame in the frame_buffer .</p>
</div></li>

<li class="function">
<h2 id="transition_slide">
unsigned <tt class="descname">transition_slide</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;frame_buffer[2]</em>, unsigned<em>&nbsp;image_from</em>, unsigned<em>&nbsp;image_to</em>, unsigned<em>&nbsp;frames</em>, unsigned<em>&nbsp;cur_fb_index</em><big>)</big></h2>
<p>Transition effect: A -&gt; B as a slide, i.e.</p>
<p>B slides over A from the right.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>c_server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>frame_buffer</h2>
<p>An array of the frame buffer image handles.</p>
</li>
<li><h2>image_from</h2>
<p>The image handle of the image to transition from.</p>
</li>
<li><h2>image_to</h2>
<p>The image handle of the image to transition to.</p>
</li>
<li><h2>frames</h2>
<p>The number of frame to take over the course of the transisiton.</p>
</li>
<li><h2>cur_fb_index</h2>
<p>The initial index of the current frame in the frame_buffer .</p>
</li>
</ul>
</div><h3 class="nosecnum compact" id="">Returns</h3>
<div><p>The final index of the current frame in the frame_buffer .</p>
</div></li>

<li class="function">
<h2 id="transition_roll">
unsigned <tt class="descname">transition_roll</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;frame_buffer[2]</em>, unsigned<em>&nbsp;image_from</em>, unsigned<em>&nbsp;image_to</em>, unsigned<em>&nbsp;frames</em>, unsigned<em>&nbsp;cur_fb_index</em><big>)</big></h2>
<p>Transition effect: A -&gt; B as a roll, i.e.</p>
<p>B rolls on from the right and A rolls off to the right.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>c_server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>frame_buffer</h2>
<p>An array of the frame buffer image handles.</p>
</li>
<li><h2>image_from</h2>
<p>The image handle of the image to transition from.</p>
</li>
<li><h2>image_to</h2>
<p>The image handle of the image to transition to.</p>
</li>
<li><h2>frames</h2>
<p>The number of frame to take over the course of the transisiton.</p>
</li>
<li><h2>cur_fb_index</h2>
<p>The initial index of the current frame in the frame_buffer .</p>
</li>
</ul>
</div><h3 class="nosecnum compact" id="">Returns</h3>
<div><p>The final index of the current frame in the frame_buffer .</p>
</div></li>

<li class="function">
<h2 id="transition_dither">
unsigned <tt class="descname">transition_dither</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;frame_buffer[2]</em>, unsigned<em>&nbsp;image_from</em>, unsigned<em>&nbsp;image_to</em>, unsigned<em>&nbsp;frames</em>, unsigned<em>&nbsp;cur_fb_index</em><big>)</big></h2>
<p>Transition effect: A -&gt; B as a dither, i.e.</p>
<p>B is revealed in 2 pixel chunks until A is gone.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>c_server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>frame_buffer</h2>
<p>An array of the frame buffer image handles.</p>
</li>
<li><h2>image_from</h2>
<p>The image handle of the image to transition from.</p>
</li>
<li><h2>image_to</h2>
<p>The image handle of the image to transition to.</p>
</li>
<li><h2>frames</h2>
<p>The number of frame to take over the course of the transisiton.</p>
</li>
<li><h2>cur_fb_index</h2>
<p>The initial index of the current frame in the frame_buffer .</p>
</li>
</ul>
</div><h3 class="nosecnum compact" id="">Returns</h3>
<div><p>The final index of the current frame in the frame_buffer .</p>
</div></li>

<li class="function">
<h2 id="transition_alpha_blend">
unsigned <tt class="descname">transition_alpha_blend</tt><big>(</big>chanend<em>&nbsp;c_server</em>, unsigned<em>&nbsp;frame_buffer[2]</em>, unsigned<em>&nbsp;image_from</em>, unsigned<em>&nbsp;image_to</em>, unsigned<em>&nbsp;frames</em>, unsigned<em>&nbsp;cur_fb_index</em><big>)</big></h2>
<p>Transition effect: A -&gt; B as a fade, i.e.</p>
<p>A fades away as B fades in.</p>
<h3 class="nosecnum compact" id="">Parameters</h3>
<div><ul class="field_list" class="latex_compact"><li><h2>c_server</h2>
<p>The channel from the client application to the display_controller.</p>
</li>
<li><h2>frame_buffer</h2>
<p>An array of the frame buffer image handles.</p>
</li>
<li><h2>image_from</h2>
<p>The image handle of the image to transition from.</p>
</li>
<li><h2>image_to</h2>
<p>The image handle of the image to transition to.</p>
</li>
<li><h2>frames</h2>
<p>The number of frame to take over the course of the transisiton.</p>
</li>
<li><h2>cur_fb_index</h2>
<p>The initial index of the current frame in the frame_buffer .</p>
</li>
</ul>
</div><h3 class="nosecnum compact" id="">Returns</h3>
<div><p>The final index of the current frame in the frame_buffer .</p>
</div></li>

</ul><p>The transitions use the display controller API.</p>
</div>

             </div>
             </div>


          </div>

          <div>
             <!--seealsos-->
          </div><div id="local_seealso">
             <h1>See Also</h1>
             <ul class="iconmenu">
             <li><a href="page0.html">Overview</a></li>
             <li><a href="page1.html">Evaluation platforms</a></li>
             <li><a href="page3.html">Programming guide</a></li>
             <li><a href="page4.html">Example application</a></li>
             </ul>
          </div>
    <div class="footer">
    </div>
  </body>
</html>